{"ast":null,"code":"var _jsxFileName = \"/Users/theophiletarbe/Desktop/cours/ING4/git_ING4/ING_4/techweb/v3/front-end/src/channel/List.js\";\nimport { forwardRef, useImperativeHandle, useLayoutEffect, useRef } from 'react';\n/** @jsx jsx */\n\nimport { jsx } from '@emotion/core'; // Layout\n\nimport { useTheme } from '@material-ui/core/styles'; // Markdown\n\nimport unified from 'unified';\nimport markdown from 'remark-parse';\nimport remark2rehype from 'remark-rehype';\nimport html from 'rehype-stringify'; // Time\n\nimport dayjs from 'dayjs';\nimport calendar from 'dayjs/plugin/calendar';\nimport updateLocale from 'dayjs/plugin/updateLocale';\ndayjs.extend(calendar);\ndayjs.extend(updateLocale);\ndayjs.updateLocale('en', {\n  calendar: {\n    sameElse: 'DD/MM/YYYY hh:mm A'\n  }\n});\n\nconst useStyles = theme => ({\n  root: {\n    position: 'relative',\n    flex: '1 1 auto',\n    overflow: 'auto',\n    '& ul': {\n      'margin': 0,\n      'padding': 0,\n      'textIndent': 0,\n      'listStyleType': 0\n    }\n  },\n  message: {\n    padding: '.2rem .5rem',\n    ':hover': {\n      backgroundColor: 'rgba(255,255,255,.05)'\n    }\n  },\n  fabWrapper: {\n    position: 'absolute',\n    right: 0,\n    top: 0,\n    width: '50px'\n  },\n  fab: {\n    position: 'fixed !important',\n    top: 0,\n    width: '50px'\n  }\n});\n\nexport default forwardRef(({\n  channel,\n  messages,\n  onScrollDown\n}, ref) => {\n  const styles = useStyles(useTheme()); // Expose the `scroll` action\n\n  useImperativeHandle(ref, () => ({\n    scroll: scroll\n  }));\n  const rootEl = useRef(null);\n  const scrollEl = useRef(null);\n\n  const scroll = () => {\n    scrollEl.current.scrollIntoView();\n  }; // See https://dev.to/n8tb1t/tracking-scroll-position-with-react-hooks-3bbj\n\n\n  const throttleTimeout = useRef(null); // react-hooks/exhaustive-deps\n\n  useLayoutEffect(() => {\n    const rootNode = rootEl.current; // react-hooks/exhaustive-deps\n\n    const handleScroll = () => {\n      if (throttleTimeout.current === null) {\n        throttleTimeout.current = setTimeout(() => {\n          throttleTimeout.current = null;\n          const {\n            scrollTop,\n            offsetHeight,\n            scrollHeight\n          } = rootNode; // react-hooks/exhaustive-deps\n\n          onScrollDown(scrollTop + offsetHeight < scrollHeight);\n        }, 200);\n      }\n    };\n\n    handleScroll();\n    rootNode.addEventListener('scroll', handleScroll);\n    return () => rootNode.removeEventListener('scroll', handleScroll);\n  });\n  return jsx(\"div\", {\n    css: styles.root,\n    ref: rootEl,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 87,\n      columnNumber: 5\n    }\n  }, jsx(\"h1\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 88,\n      columnNumber: 7\n    }\n  }, \"Messages for \", channel.name), jsx(\"ul\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 89,\n      columnNumber: 7\n    }\n  }, messages.map((message, i) => {\n    const {\n      contents: content\n    } = unified().use(markdown).use(remark2rehype).use(html).processSync(message.content);\n    return jsx(\"li\", {\n      key: i,\n      css: styles.message,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 97,\n        columnNumber: 15\n      }\n    }, jsx(\"p\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 98,\n        columnNumber: 17\n      }\n    }, jsx(\"span\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 99,\n        columnNumber: 19\n      }\n    }, message.author), ' - ', jsx(\"span\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 101,\n        columnNumber: 19\n      }\n    }, dayjs().calendar(message.creation))), jsx(\"div\", {\n      dangerouslySetInnerHTML: {\n        __html: content\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 103,\n        columnNumber: 17\n      }\n    }));\n  })), jsx(\"div\", {\n    ref: scrollEl,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 109,\n      columnNumber: 7\n    }\n  }));\n});","map":{"version":3,"sources":["/Users/theophiletarbe/Desktop/cours/ING4/git_ING4/ING_4/techweb/v3/front-end/src/channel/List.js"],"names":["forwardRef","useImperativeHandle","useLayoutEffect","useRef","jsx","useTheme","unified","markdown","remark2rehype","html","dayjs","calendar","updateLocale","extend","sameElse","useStyles","theme","root","position","flex","overflow","message","padding","backgroundColor","fabWrapper","right","top","width","fab","channel","messages","onScrollDown","ref","styles","scroll","rootEl","scrollEl","current","scrollIntoView","throttleTimeout","rootNode","handleScroll","setTimeout","scrollTop","offsetHeight","scrollHeight","addEventListener","removeEventListener","name","map","i","contents","content","use","processSync","author","creation","__html"],"mappings":";AAAA,SAAQA,UAAR,EAAoBC,mBAApB,EAAyCC,eAAzC,EAA0DC,MAA1D,QAAuE,OAAvE;AACA;;AACA,SAASC,GAAT,QAAoB,eAApB,C,CACA;;AACA,SAASC,QAAT,QAAyB,0BAAzB,C,CACA;;AACA,OAAOC,OAAP,MAAoB,SAApB;AACA,OAAOC,QAAP,MAAqB,cAArB;AACA,OAAOC,aAAP,MAA0B,eAA1B;AACA,OAAOC,IAAP,MAAiB,kBAAjB,C,CACA;;AACA,OAAOC,KAAP,MAAkB,OAAlB;AACA,OAAOC,QAAP,MAAqB,uBAArB;AACA,OAAOC,YAAP,MAAyB,2BAAzB;AACAF,KAAK,CAACG,MAAN,CAAaF,QAAb;AACAD,KAAK,CAACG,MAAN,CAAaD,YAAb;AACAF,KAAK,CAACE,YAAN,CAAmB,IAAnB,EAAyB;AACvBD,EAAAA,QAAQ,EAAE;AACRG,IAAAA,QAAQ,EAAE;AADF;AADa,CAAzB;;AAMA,MAAMC,SAAS,GAAIC,KAAD,KAAY;AAC5BC,EAAAA,IAAI,EAAE;AACJC,IAAAA,QAAQ,EAAE,UADN;AAEJC,IAAAA,IAAI,EAAE,UAFF;AAGJC,IAAAA,QAAQ,EAAE,MAHN;AAIJ,YAAQ;AACN,gBAAU,CADJ;AAEN,iBAAW,CAFL;AAGN,oBAAc,CAHR;AAIN,uBAAiB;AAJX;AAJJ,GADsB;AAY5BC,EAAAA,OAAO,EAAE;AACPC,IAAAA,OAAO,EAAE,aADF;AAEP,cAAU;AACRC,MAAAA,eAAe,EAAE;AADT;AAFH,GAZmB;AAkB5BC,EAAAA,UAAU,EAAE;AACVN,IAAAA,QAAQ,EAAE,UADA;AAEVO,IAAAA,KAAK,EAAE,CAFG;AAGVC,IAAAA,GAAG,EAAE,CAHK;AAIVC,IAAAA,KAAK,EAAE;AAJG,GAlBgB;AAwB5BC,EAAAA,GAAG,EAAE;AACHV,IAAAA,QAAQ,EAAE,kBADP;AAEHQ,IAAAA,GAAG,EAAE,CAFF;AAGHC,IAAAA,KAAK,EAAE;AAHJ;AAxBuB,CAAZ,CAAlB;;AA+BA,eAAe3B,UAAU,CAAC,CAAC;AACzB6B,EAAAA,OADyB;AAEzBC,EAAAA,QAFyB;AAGzBC,EAAAA;AAHyB,CAAD,EAIvBC,GAJuB,KAIf;AACT,QAAMC,MAAM,GAAGlB,SAAS,CAACV,QAAQ,EAAT,CAAxB,CADS,CAET;;AACAJ,EAAAA,mBAAmB,CAAC+B,GAAD,EAAM,OAAO;AAC9BE,IAAAA,MAAM,EAAEA;AADsB,GAAP,CAAN,CAAnB;AAGA,QAAMC,MAAM,GAAGhC,MAAM,CAAC,IAAD,CAArB;AACA,QAAMiC,QAAQ,GAAGjC,MAAM,CAAC,IAAD,CAAvB;;AACA,QAAM+B,MAAM,GAAG,MAAM;AACnBE,IAAAA,QAAQ,CAACC,OAAT,CAAiBC,cAAjB;AACD,GAFD,CARS,CAWT;;;AACA,QAAMC,eAAe,GAAGpC,MAAM,CAAC,IAAD,CAA9B,CAZS,CAY4B;;AACrCD,EAAAA,eAAe,CAAE,MAAM;AACrB,UAAMsC,QAAQ,GAAGL,MAAM,CAACE,OAAxB,CADqB,CACW;;AAChC,UAAMI,YAAY,GAAG,MAAM;AACzB,UAAIF,eAAe,CAACF,OAAhB,KAA4B,IAAhC,EAAsC;AACpCE,QAAAA,eAAe,CAACF,OAAhB,GAA0BK,UAAU,CAAC,MAAM;AACzCH,UAAAA,eAAe,CAACF,OAAhB,GAA0B,IAA1B;AACA,gBAAM;AAACM,YAAAA,SAAD;AAAYC,YAAAA,YAAZ;AAA0BC,YAAAA;AAA1B,cAA0CL,QAAhD,CAFyC,CAEgB;;AACzDT,UAAAA,YAAY,CAACY,SAAS,GAAGC,YAAZ,GAA2BC,YAA5B,CAAZ;AACD,SAJmC,EAIjC,GAJiC,CAApC;AAKD;AACF,KARD;;AASAJ,IAAAA,YAAY;AACZD,IAAAA,QAAQ,CAACM,gBAAT,CAA0B,QAA1B,EAAoCL,YAApC;AACA,WAAO,MAAMD,QAAQ,CAACO,mBAAT,CAA6B,QAA7B,EAAuCN,YAAvC,CAAb;AACD,GAdc,CAAf;AAeA,SACE;AAAK,IAAA,GAAG,EAAER,MAAM,CAAChB,IAAjB;AAAuB,IAAA,GAAG,EAAEkB,MAA5B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,sBAAkBN,OAAO,CAACmB,IAA1B,CADF,EAEE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACIlB,QAAQ,CAACmB,GAAT,CAAc,CAAC5B,OAAD,EAAU6B,CAAV,KAAgB;AAC5B,UAAM;AAACC,MAAAA,QAAQ,EAAEC;AAAX,QAAsB9C,OAAO,GAClC+C,GAD2B,CACvB9C,QADuB,EAE3B8C,GAF2B,CAEvB7C,aAFuB,EAG3B6C,GAH2B,CAGvB5C,IAHuB,EAI3B6C,WAJ2B,CAIfjC,OAAO,CAAC+B,OAJO,CAA5B;AAKA,WACE;AAAI,MAAA,GAAG,EAAEF,CAAT;AAAY,MAAA,GAAG,EAAEjB,MAAM,CAACZ,OAAxB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OAAOA,OAAO,CAACkC,MAAf,CADF,EAEG,KAFH,EAGE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OAAO7C,KAAK,GAAGC,QAAR,CAAiBU,OAAO,CAACmC,QAAzB,CAAP,CAHF,CADF,EAME;AAAK,MAAA,uBAAuB,EAAE;AAACC,QAAAA,MAAM,EAAEL;AAAT,OAA9B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MANF,CADF;AAWH,GAjBC,CADJ,CAFF,EAsBE;AAAK,IAAA,GAAG,EAAEhB,QAAV;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IAtBF,CADF;AA0BD,CA1DwB,CAAzB","sourcesContent":["import {forwardRef, useImperativeHandle, useLayoutEffect, useRef} from 'react'\n/** @jsx jsx */\nimport { jsx } from '@emotion/core'\n// Layout\nimport { useTheme } from '@material-ui/core/styles';\n// Markdown\nimport unified from 'unified'\nimport markdown from 'remark-parse'\nimport remark2rehype from 'remark-rehype'\nimport html from 'rehype-stringify'\n// Time\nimport dayjs from 'dayjs'\nimport calendar from 'dayjs/plugin/calendar'\nimport updateLocale from 'dayjs/plugin/updateLocale'\ndayjs.extend(calendar)\ndayjs.extend(updateLocale)\ndayjs.updateLocale('en', {\n  calendar: {\n    sameElse: 'DD/MM/YYYY hh:mm A'\n  }\n})\n\nconst useStyles = (theme) => ({\n  root: {\n    position: 'relative',\n    flex: '1 1 auto',\n    overflow: 'auto',\n    '& ul': {\n      'margin': 0,\n      'padding': 0,\n      'textIndent': 0,\n      'listStyleType': 0,\n    },\n  },\n  message: {\n    padding: '.2rem .5rem',\n    ':hover': {\n      backgroundColor: 'rgba(255,255,255,.05)',\n    },\n  },\n  fabWrapper: {\n    position: 'absolute',\n    right: 0,\n    top: 0,\n    width: '50px',\n  },\n  fab: {\n    position: 'fixed !important',\n    top: 0,\n    width: '50px',\n  },\n})\n\nexport default forwardRef(({\n  channel,\n  messages,\n  onScrollDown,\n}, ref) => {\n  const styles = useStyles(useTheme())\n  // Expose the `scroll` action\n  useImperativeHandle(ref, () => ({\n    scroll: scroll\n  }));\n  const rootEl = useRef(null)\n  const scrollEl = useRef(null)\n  const scroll = () => {\n    scrollEl.current.scrollIntoView()\n  }\n  // See https://dev.to/n8tb1t/tracking-scroll-position-with-react-hooks-3bbj\n  const throttleTimeout = useRef(null) // react-hooks/exhaustive-deps\n  useLayoutEffect( () => {\n    const rootNode = rootEl.current // react-hooks/exhaustive-deps\n    const handleScroll = () => {\n      if (throttleTimeout.current === null) {\n        throttleTimeout.current = setTimeout(() => {\n          throttleTimeout.current = null\n          const {scrollTop, offsetHeight, scrollHeight} = rootNode // react-hooks/exhaustive-deps\n          onScrollDown(scrollTop + offsetHeight < scrollHeight)\n        }, 200)\n      }\n    }\n    handleScroll()\n    rootNode.addEventListener('scroll', handleScroll)\n    return () => rootNode.removeEventListener('scroll', handleScroll)\n  })\n  return (\n    <div css={styles.root} ref={rootEl}>\n      <h1>Messages for {channel.name}</h1>\n      <ul>\n        { messages.map( (message, i) => {\n            const {contents: content} = unified()\n            .use(markdown)\n            .use(remark2rehype)\n            .use(html)\n            .processSync(message.content)\n            return (\n              <li key={i} css={styles.message}>\n                <p>\n                  <span>{message.author}</span>\n                  {' - '}\n                  <span>{dayjs().calendar(message.creation)}</span>\n                </p>\n                <div dangerouslySetInnerHTML={{__html: content}}>\n                </div>\n              </li>\n            )\n        })}\n      </ul>\n      <div ref={scrollEl} />\n    </div>\n  )\n})\n"]},"metadata":{},"sourceType":"module"}